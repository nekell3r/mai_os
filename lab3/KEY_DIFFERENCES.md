# –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è Lab3 –æ—Ç Lab1

## Lab1 vs Lab3 - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –º–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é

### Lab1: Pipes (Anonymous Pipes)

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```cpp
// –°–æ–∑–¥–∞–Ω–∏–µ pipe'–æ–≤
CreatePipe(&pipe_read, &pipe_write, &sa, 0);

// –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö
WriteFile(pipe_write, &number, sizeof(int), &bytes_written, nullptr);

// –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
ReadFile(pipe_read, &response, sizeof(int), &bytes_read, nullptr);
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
- ‚úÖ –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø
- ‚ùå –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

---

### Lab3: File Mapping + Events

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```cpp
// –°–æ–∑–¥–∞–Ω–∏–µ shared memory
HANDLE hMapFile = CreateFileMappingA(
    INVALID_HANDLE_VALUE,
    nullptr,
    PAGE_READWRITE,
    0,
    sizeof(SharedData),
    "Local\\Lab3SharedMemory"
);

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç—å
SharedData* pSharedData = static_cast<SharedData*>(
    MapViewOfFile(hMapFile, FILE_MAP_ALL_ACCESS, 0, 0, sizeof(SharedData))
);

// –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è
HANDLE hEvent = CreateEventA(nullptr, FALSE, FALSE, "Local\\Lab3Event");

// –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
pSharedData->number = 42;
SetEvent(hEvent);  // –°–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥—Ä—É–≥–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É

// –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
WaitForSingleObject(hEvent, INFINITE);
int result = pSharedData->response;
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø (–±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è)
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- ‚ùå –°–ª–æ–∂–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- ‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è —è–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

---

## –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ê—Å–ø–µ–∫—Ç | Lab1 (Pipes) | Lab3 (File Mapping) |
|--------|--------------|---------------------|
| **API** | CreatePipe, ReadFile, WriteFile | CreateFileMapping, MapViewOfFile, CreateEvent |
| **–ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö** | –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —è–¥—Ä–æ –û–° | –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ shared memory |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | –°—Ä–µ–¥–Ω—è—è | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è |
| **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è (–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏) | –Ø–≤–Ω–∞—è (—á–µ—Ä–µ–∑ Events) |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞** | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö** | –ü–æ—Ç–æ–∫ –±–∞–π—Ç–æ–≤ | –°—Ç—Ä—É–∫—Ç—É—Ä—ã C++ |
| **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏** | –ë—É—Ñ–µ—Ä –≤ —è–¥—Ä–µ | Shared memory |
| **–¢–∏–ø–∏—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ** | –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö, pipe-line | –†–∞–∑–¥–µ–ª—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ, IPC |

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### Lab1 (Pipes):
```
Parent -> [Kernel Buffer] -> Child
  |            |               |
  Write    (Copy data)      Read
```
- **2 —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–∞** (WriteFile + ReadFile)
- **1 –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** (–≤ –±—É—Ñ–µ—Ä —è–¥—Ä–∞)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏/–∑–∞–ø–∏—Å–∏

### Lab3 (File Mapping):
```
Parent -> [Shared Memory] <- Child
  |              |            |
  Write      (Direct)      Read
```
- **0 –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö** (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏)
- **–Ø–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** —á–µ—Ä–µ–∑ Events
- **–ú–∏–Ω–∏–º—É–º —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤** –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

---

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pipes (Lab1) –∫–æ–≥–¥–∞:
- üìù –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö
- üì¶ –ë–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã –¥–∞–Ω–Ω—ã—Ö
- üîÑ –ü—Ä–æ—Å—Ç–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- üöÄ –ù—É–∂–Ω–∞ –±—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- üë∂ –ü—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ File Mapping (Lab3) –∫–æ–≥–¥–∞:
- ‚ö° –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üèóÔ∏è –°–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- üîÄ –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
- üíæ –†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- üéØ –ù—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ SharedData –≤ Lab3

```cpp
struct SharedData {
    int number;              // –ß–∏—Å–ª–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    int response;            // –û—Ç–≤–µ—Ç –æ—Ç –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    bool has_request;        // –§–ª–∞–≥ –Ω–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
    bool has_response;       // –§–ª–∞–≥ –Ω–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
    bool should_terminate;   // –§–ª–∞–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
};
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è
- –ù–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

---

## –°–æ–±—ã—Ç–∏—è (Events) –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### Auto-reset Events (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ Lab3):
```cpp
HANDLE hEvent = CreateEventA(
    nullptr,    // –ê—Ç—Ä–∏–±—É—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    FALSE,      // Auto-reset (–ù–ï manual-reset)
    FALSE,      // –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: non-signaled
    "EventName" // –ò–º—è —Å–æ–±—ã—Ç–∏—è
);
```

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
1. `SetEvent(hEvent)` ‚Üí —Å–æ–±—ã—Ç–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è signaled
2. `WaitForSingleObject(hEvent, INFINITE)` ‚Üí –ø–æ—Ç–æ–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** ‚Üí —Å–æ–±—ã—Ç–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è non-signaled
4. –ù–µ –Ω—É–∂–µ–Ω `ResetEvent()`

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–∏–ø–∞ "ping-pong"
- –û–¥–∏–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å - –æ–¥–∏–Ω –ø–æ–ª—É—á–∞—Ç–µ–ª—å
- –ó–∞–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç

---

## –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã Windows

### –ü—Ä–µ—Ñ–∏–∫—Å `Local\\`:
```cpp
"Local\\Lab3SharedMemory"   // File mapping
"Local\\Lab3EventRequest"   // Event –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
"Local\\Lab3EventResponse"  // Event –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
```

**–ó–∞—á–µ–º:**
- –î–æ—Å—Ç—É–ø –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ò–∑–æ–ª—è—Ü–∏—è –≤ —Ä–∞–º–∫–∞—Ö —Å–µ–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏–º—ë–Ω

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- `Global\\` - –¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º —Å–µ–∞–Ω—Å–∞–º (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤)
- –ë–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞ - `Local\\` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

---

## –û—à–∏–±–∫–∏ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏–µ

### Lab1 (Pipes):
| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| Deadlock | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ | –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å Close |
| Broken pipe | Child –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π |

### Lab3 (File Mapping):
| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| Access violation | MapViewOfFile –≤–µ—Ä–Ω—É–ª NULL | –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ nullptr |
| Timeout | Child –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª Event | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ |
| Race condition | –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø | –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–ª–∞–≥–æ–≤ |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Lab1 (Pipes):**
- –û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª–µ–π
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ Unix/Windows

**Lab3 (File Mapping):**
- –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ì–∏–±–∫–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

**–û–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –∏–º–µ—é—Ç —Å–≤–æ—ë –º–µ—Å—Ç–æ** –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö. –í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–Ω–∏–≥–∏:
- "Windows System Programming" by Johnson M. Hart
- "Programming Windows" by Charles Petzold

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [File Mapping (MSDN)](https://docs.microsoft.com/en-us/windows/win32/memory/file-mapping)
- [Synchronization (MSDN)](https://docs.microsoft.com/en-us/windows/win32/sync/synchronization)
- [Pipes (MSDN)](https://docs.microsoft.com/en-us/windows/win32/ipc/pipes)

